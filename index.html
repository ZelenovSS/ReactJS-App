<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>ToDo App</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    <script src="https://unpkg.com/prop-types@15.6/prop-types.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">

// Создаваемая задача
    class CurrentTask extends React.Component {
        state = {
            completed: false,
            text: this.props.data.text,
            id: this.props.data.id,
        };
        handleCompletedTaskClick = () => {
            this.setState({completed: !this.state.completed})
        };

        render() {
            const {text} = this.props.data;
            return (
                <div className="current-task">
                    <input type="checkbox" onChange={this.handleCompletedTaskClick} className="task-check"/>
                    <span className="task-text">{text}</span>
                    <button className="task-delete" onClick={() => this.props.delete(this.state)}>Del</button>
                </div>

            )
        }
    }
    CurrentTask.propTypes = {
        data: PropTypes.shape({
            id: PropTypes.number.isRequired,
            text: PropTypes.string.isRequired
        })
    };

// Все задачи
    class Tasks extends React.Component {
        renderTasks = () => {
            const {data, del} = this.props;
            let taskTemplate = null;
            if (data.length) {
                taskTemplate = data.map((item) => {
                    return <CurrentTask key={item.id} data={item} delete={del}/>
                });
            } else {
                taskTemplate = <p>No Tasks</p>
            }
            return taskTemplate
        };
        render() {
            const {data} = this.props;
            return (
                <div className="task-element">
                    {this.renderTasks()}
                    {data.length ? <p>Tasks left: {data.length}</p> : null}
                </div>
            );
        };

    }

    Tasks.propTypes = {
        data: PropTypes.array.isRequired
    };
// Добавление задачи
    class Add extends React.Component {
        state = {
            text: ''
        };
        onAddEnter = (e) => {
            if (e.keyCode === 13) {
                this.onAddBtnClick()
            }
        };
        onAddBtnClick = () => {
            const {text} = this.state;
            this.props.onAddTasks({
                id: +new Date(),
                text
            });
            this.setState({text: ''})
        };
        handleTaskChange = (e) => {
            this.setState({text: e.currentTarget.value});
            e.currentTarget.value = '';
        };
        validate = () => {
            const {text} = this.state;
            return !!text.trim();
        };
        render() {
            const {text} = this.state;
            return (
                <div>
                    <label className="check-all">
                    <input
                        type="checkbox"
                        />
                    <input
                        type="text"
                        onChange={this.handleTaskChange}
                        className="input-task"
                        placeholder="What needs to be done?"
                        value={text}
                        onKeyDown={(e) => this.onAddEnter(e)}
                    />
                        <button
                            className="add-task"
                            onClick={this.onAddBtnClick}
                            disabled={!this.validate()}>
                            Add task
                        </button>
                    </label>
                </div>
            )
        }
    }

    Add.propTypes = {
        onAddTasks: PropTypes.func.isRequired,
    };

// Удаление



// Общий вид
    class App extends React.Component {
        state = {
            tasks: [],
        };
        handleAddTasks = (data) => {
            const nextTask = [data, ...this.state.tasks];
            this.setState({tasks: nextTask});
        };
        onDelBtnClick = (e) => {
            let newArr = this.state.tasks.filter(item => {
                    return item.id !== e.id

            });
            this.setState ({
                tasks: newArr
            })
            // this.state.tasks.splice(curren)
        };
        render() {
            return (
                <div className="container">
                    <h1>To Do List</h1>
                    <Add onAddTasks={this.handleAddTasks}/>
                    <p/>
                    <Tasks del={this.onDelBtnClick} data={this.state.tasks}/>
                </div>
            )
        }
    }



    ReactDOM.render(
        <App/>,
        document.getElementById('root')
    );

</script>
</body>
</html>